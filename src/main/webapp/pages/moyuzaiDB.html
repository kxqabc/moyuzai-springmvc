<!DOCTYPE html>
<html>
<head>
<!-- <meta charset="utf-8"http-equiv="Access-Control-Allow-Origin" content="*"> -->
<meta charset="utf-8">
<!-- 包含头部信息用于适应不同设备 -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- 包含 bootstrap 样式表 -->
<link rel="stylesheet" href="bootstrap.min.css">
<title>墨鱼仔-测试</title>
<script src="jquery-1.10.2.min.js">
</script>
</head>

<script type="text/javascript">
  // "http://139.199.170.95:8080/moyuzaiServer/Controller?type=queryAllUsers&callback=?"
    $(function(){
      $("#user").click(function(){    //user按钮功能
          $(this).attr("disable","true");
        showUserList();
      });
    });
</script>

<script type="text/javascript">
  function showUserList(){
      var $this = $(this);
      $this.attr("disabled","true");
      $.getJSON("http://localhost:8080/Controller?type=users&pageNum=1",
          function(data){
              var array = data["identity"];
              // rowspan=$rowspan style='vertical-align: middle;text-align: center;水平垂直居中！
              $("table").append("<tr> <td rowspan=$rowspan style='vertical-align: middle;text-align: center;'>" + "用户id" + "</td>" +
              "<td rowspan=$rowspan style='vertical-align: middle;text-align: center;'>" + "用户名称" + "</td>" +
              "<td rowspan=$rowspan style='vertical-align: middle;text-align: center;'>" + "手机号" + "</td>" +
              "<td rowspan=$rowspan style='vertical-align: middle;text-align: center;'>" + "操作" + "</td>+</tr>");
              $.each(array, function (index, element) {
                var button = $("<button type='button' class='btn btn-default'>index</button>");
                  $("tbody").append("<tr><td rowspan=$rowspan style='vertical-align: middle;text-align: center;'>" + element["id"] + "</td>" +
                  "<td rowspan=$rowspan style='vertical-align: middle;text-align: center;'>" + element["userName"] + "</td>" +
                  "<td rowspan=$rowspan style='vertical-align: middle;text-align: center;'>" + element["mobile"] + "</td>"+
                  "<td class='cell' rowspan=$rowspan style='vertical-align: middle;text-align: center;'>删除</td>" + "</tr>");
                });
              $(".cell").click(function(){
                var $this = $(this);
                var userId = $this.prev().prev().prev().text();
                var result = confirm("确定删除用户："+$this.prev().prev().text()+"？");
                if (result == true) {
                    deleteUser(userId);
                    $this.parent().parent().empty();    //清空整个表格
                }
              }
            );
          });
        }
</script>

<script>
    function deleteUser(userId) {
        $.getJSON("http://localhost:8080/Controller?type=deleteUser&userId="+userId,
            function(data){
                showUserList();
                var array = data["state"];
            });
    }
</script>


<div class="btn-group btn-group-justified">
    <button type="button" id="user" class="btn btn-default">用户</button>
    <button type="button" id="group" class="btn btn-default">群组</button>
    <button type="button" id="user_group" class="btn btn-default">关系表</button>
</div>

<div class="container">
  <table class="table table-striped table-bordered table-hover" id="form1">
    <thead>
      <tbody>
      </tbody>
    </thead>
  </table>
</div>
</body>
</html>
